; PlatformIO Project Configuration File for Battery-Optimized Sensor
;
; Build for ESP32 with VEML7700, AHT25, MICS5524
; Optimized for low power consumption with PainlessMesh
;
; Upload this to your ESP32 and expect 24-48 hours on 400mAh LiPo

[env:esp32-battery-optimized]
platform = espressif32
board = esp32dev
framework = arduino

; Optimization flags for smaller binary and better power management
build_flags =
    -D CORE_DEBUG_LEVEL=1                  ; Minimal logging to save power
    -D CONFIG_ARDUHAL_LOG_DEFAULT_LEVEL_INFO
    -O2                                     ; Optimize for size and speed

; Monitor settings
monitor_speed = 115200
monitor_filters =
    esp32_exception_decoder
    time

; Upload settings
upload_speed = 921600

; Dependencies
lib_deps =
    painlessmesh/painlessMesh@^1.5.0
    adafruit/Adafruit VEML7700 Library@^2.1.7
    adafruit/Adafruit AHTX0@^2.0.5
    adafruit/Adafruit Unified Sensor@^1.1.14
    bblanchon/ArduinoJson@^7.4.2

; Partition scheme - optimize for OTA if needed
board_build.partitions = default.csv

; Flash frequency
board_build.f_flash = 80000000L

; CPU frequency - can reduce to 80MHz for even lower power
; board_build.f_cpu = 80000000L  ; Uncomment for 80MHz (saves ~20mA)
board_build.f_cpu = 240000000L    ; Default 240MHz


; ===================================================================
; Alternative configurations for different scenarios
; ===================================================================

; Ultra-low power: 80MHz CPU, minimal logging
[env:esp32-ultra-low-power]
platform = espressif32
board = esp32dev
framework = arduino

build_flags =
    -D CORE_DEBUG_LEVEL=0                  ; No debug logging
    -O2                                     ; Optimize for size

monitor_speed = 115200
upload_speed = 921600

board_build.f_cpu = 80000000L              ; 80MHz CPU (lower power)

lib_deps =
    painlessmesh/painlessMesh@^1.5.0
    adafruit/Adafruit VEML7700 Library@^2.1.7
    adafruit/Adafruit AHTX0@^2.0.5
    adafruit/Adafruit Unified Sensor@^1.1.14
    bblanchon/ArduinoJson@^7.4.2


; Development build: full logging, debugging enabled
[env:esp32-debug]
platform = espressif32
board = esp32dev
framework = arduino

build_flags =
    -D CORE_DEBUG_LEVEL=5                  ; Verbose logging
    -D CONFIG_ARDUHAL_LOG_DEFAULT_LEVEL_VERBOSE
    -g                                      ; Debug symbols

monitor_speed = 115200
monitor_filters =
    esp32_exception_decoder
    log2file
    time

upload_speed = 921600

lib_deps =
    painlessmesh/painlessMesh@^1.5.0
    adafruit/Adafruit VEML7700 Library@^2.1.7
    adafruit/Adafruit AHTX0@^2.0.5
    adafruit/Adafruit Unified Sensor@^1.1.14
    bblanchon/ArduinoJson@^7.4.2


; BME680 alternative (replaces MICS5524 + AHT25 for better power)
[env:esp32-bme680]
platform = espressif32
board = esp32dev
framework = arduino

build_flags =
    -D USE_BME680                          ; Use BME680 instead of separate sensors
    -D CORE_DEBUG_LEVEL=1
    -O2

monitor_speed = 115200
upload_speed = 921600

lib_deps =
    painlessmesh/painlessMesh@^1.5.0
    adafruit/Adafruit VEML7700 Library@^2.1.7
    adafruit/Adafruit BME680 Library@^2.0.4
    adafruit/Adafruit Unified Sensor@^1.1.14
    bblanchon/ArduinoJson@^7.4.2
