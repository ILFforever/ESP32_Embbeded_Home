### API Testing File for VS Code REST Client Extension
### Install "REST Client" extension by Huachao Mao to use this file

@baseUrl = http://localhost:5000/api/v1/auth
@token =

### 1. Register a regular user
POST {{baseUrl}}/register
Content-Type: application/json

{
  "name": "John Doe",
  "telephone_number": "123-4567890",
  "email": "john@example.com",
  "password": "password123",
  "role": "user"
}

### 2. Register an admin user
POST {{baseUrl}}/register
Content-Type: application/json

{
  "name": "Admin User",
  "telephone_number": "999-8887777",
  "email": "admin@example.com",
  "password": "admin123",
  "role": "admin"
}

### 3. Login as admin (copy the token from response)
POST {{baseUrl}}/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "admin123"
}

### 4. Login as regular user
POST {{baseUrl}}/login
Content-Type: application/json

{
  "email": "john@example.com",
  "password": "password123"
}

### 5. Get current user (replace token)
POST {{baseUrl}}/curuser
Authorization: Bearer {{token}}

### 6. Get all admins (admin only)
GET {{baseUrl}}/admins
Authorization: Bearer {{token}}

### 7. Get all users (admin only)
GET {{baseUrl}}/users
Authorization: Bearer {{token}}

### 8. Delete a user (replace USER_ID and use admin token)
DELETE {{baseUrl}}/users/USER_ID
Authorization: Bearer {{token}}

### 9. Delete an admin (replace ADMIN_ID and use admin token)
DELETE {{baseUrl}}/admins/ADMIN_ID
Authorization: Bearer {{token}}

### 10. Logout
GET {{baseUrl}}/logout
Authorization: Bearer {{token}}

###############################################################################
### Device Endpoints
###############################################################################

@deviceBaseUrl = http://localhost:5000/api/v1/devices
@deviceToken = YOUR_DEVICE_TOKEN_HERE

### 11. Register a new device (get API token)
POST {{deviceBaseUrl}}/register
Content-Type: application/json

{
  "device_id": "doorbell_001",
  "device_type": "doorbell",
  "name": "Front Door Doorbell"
}

### 12. Send device heartbeat
POST {{deviceBaseUrl}}/heartbeat
Content-Type: application/json
X-Device-Token: {{deviceToken}}

{
  "device_id": "doorbell_001",
  "device_type": "doorbell",
  "uptime_ms": 3600000,
  "free_heap": 102400,
  "wifi_rssi": -45,
  "ip_address": "192.168.1.100"
}

### 13. Send sensor data
POST {{deviceBaseUrl}}/sensor
Content-Type: application/json
X-Device-Token: {{deviceToken}}

{
  "device_id": "room_sensor_001",
  "sensors": {
    "temperature": 23.5,
    "humidity": 45.2,
    "motion": true
  }
}

### 14. Doorbell ring event (NEW!) - Known visitor
POST {{deviceBaseUrl}}/doorbell/ring
Content-Type: application/json
X-Device-Token: {{deviceToken}}

{
  "device_id": "doorbell_001",
  "visitor_name": "John Smith",
  "face_detected": true,
  "image_url": "https://example.com/doorbell/capture/12345.jpg"
}

### 15. Doorbell ring event - Unknown visitor
POST {{deviceBaseUrl}}/doorbell/ring
Content-Type: application/json
X-Device-Token: {{deviceToken}}

{
  "device_id": "doorbell_001",
  "face_detected": false
}

### 16. Get all devices status (for frontend)
GET {{deviceBaseUrl}}/status/all

### 17. Get specific device status
GET {{deviceBaseUrl}}/doorbell_001/status

### 18. Get device history
GET {{deviceBaseUrl}}/doorbell_001/history?limit=10
